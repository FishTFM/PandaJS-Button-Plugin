game.module("plugins.button").body(function(){game.Button=game.Class.extend({text:"Button",font:{family:"Verdana",size:14,color:"#222222"},position:{x:0,y:0},size:{width:100,height:40},background:0,border:16777215,borderSize:3,container:null,scale:false,enabled:true,sprite:null,texts:null,callback:null,init:function(e,t){e=e?e:{};this.text=e.text||this.text;this.font=e.font||this.font;this.position=e.position||this.position;this.size=e.size||this.size;this.background=e.background||this.background;this.border=e.border||this.border;this.borderSize=e.borderSize||this.borderSize;this.container=e.container;this.callback=t;this.scale=e.scale||this.scale;this.enabled=e.enabled||this.enabled;this.render();var n={sprite:this.sprite,text:this.texts};return n},render:function(){this.sprite=new game.Graphics;this.sprite.beginFill(this.border);this.sprite.drawRect(-this.size.width/2,-this.size.height/2,this.size.width,this.size.height);this.sprite.beginFill(this.background);this.sprite.drawRect(-this.size.width/2+this.borderSize,-this.size.height/2+this.borderSize,this.size.width-this.borderSize*2,this.size.height-this.borderSize*2);this.sprite.position.set(this.position.x- -this.size.width/2,this.position.y- -this.size.height/2);this.offset=new game.Point;if(this.enabled){this.sprite.interactive=true;this.sprite.buttonMode=true;this.sprite.mousedown=this.onClick.bind(this);this.sprite.mouseup=this.onRelease.bind(this);this.sprite.mouseover=this.onHover.bind(this);this.sprite.mouseout=this.onLeave.bind(this)}else{this.sprite.interactive=false;this.sprite.buttonMode=false}this.texts=new game.Text(this.text,{font:this.font.size+"px "+this.font.family,fill:this.font.color});this.texts.position.set(this.position.x+this.size.width/2,this.position.y+this.size.height/2);this.texts.anchor.set(.5,.5);this.container.addChild(this.sprite);this.container.addChild(this.texts)},setText:function(e){this.texts.setText(e);this.texts.remove();this.texts.addTo(this.container)},enable:function(){this.enabled=true;this.sprite.alpha=1;this.render();this.sprite.remove();this.sprite.addTo(this.container);this.texts.remove();this.texts.addTo(this.container)},disable:function(){this.enabled=false;this.sprite.alpha=.7;this.render();this.sprite.remove();this.sprite.addTo(this.container);this.texts.remove();this.texts.addTo(this.container)},onClick:function(e){if(!this.enabled)return;if(this.scale){game.scene.current=this;this.offset.x=this.sprite.position.x-e.global.x;this.offset.y=this.sprite.position.y-e.global.y;this.sprite.scale.set(1.1,1.1);this.texts.scale.set(1.1,1.1);this.sprite.remove();this.sprite.addTo(this.container);this.texts.remove();this.texts.addTo(this.container)}this.callback()},onRelease:function(){if(!this.enabled)return;if(this.scale){game.scene.current=null;this.sprite.scale.set(1,1);this.texts.scale.set(1,1)}},onHover:function(){if(!this.enabled)return;this.sprite.alpha=.9},onLeave:function(){if(!this.enabled)return;this.sprite.alpha=1}})})
