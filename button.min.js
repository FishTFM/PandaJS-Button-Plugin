game.module("plugins.button").body(function(){game.Button=game.Class.extend({text:"Button",font:{family:"Verdana",size:14,color:"#222222"},position:{x:0,y:0},size:{width:100,height:40},background:0,border:16777215,borderSize:3,container:null,scale:!1,enabled:!0,sprite:null,texts:null,callback:null,init:function(t,i){t=t?t:{},this.text=t.text||this.text,this.font=t.font||this.font,this.position=t.position||this.position,this.size=t.size||this.size,this.background=t.background||this.background,this.border=t.border||this.border,this.borderSize=t.borderSize||this.borderSize,this.container=t.container,this.callback=i,this.scale=t.scale||this.scale,this.enabled=t.enabled||this.enabled,this.render();var s={sprite:this.sprite,text:this.texts};return s},render:function(){this.sprite=new game.Graphics,this.sprite.beginFill(this.border),this.sprite.drawRect(-this.size.width/2,-this.size.height/2,this.size.width,this.size.height),this.sprite.beginFill(this.background),this.sprite.drawRect(-this.size.width/2+this.borderSize,-this.size.height/2+this.borderSize,this.size.width-2*this.borderSize,this.size.height-2*this.borderSize),this.sprite.position.set(this.position.x- -this.size.width/2,this.position.y- -this.size.height/2),this.offset=new game.Point,this.enabled?(this.sprite.interactive=!0,this.sprite.buttonMode=!0,this.sprite.mousedown=this.onClick.bind(this),this.sprite.mouseup=this.onRelease.bind(this),this.sprite.mouseover=this.onHover.bind(this),this.sprite.mouseout=this.onLeave.bind(this)):(this.sprite.interactive=!1,this.sprite.buttonMode=!1),this.texts=new game.Text(this.text,{font:this.font.size+"px "+this.font.family,fill:this.font.color}),this.texts.position.set(this.position.x+this.size.width/2,this.position.y+this.size.height/2),this.texts.anchor.set(.5,.5),this.container.addChild(this.sprite),this.container.addChild(this.texts)},setText:function(t){this.text=t,this.texts.setText(t),this.texts.remove(),this.texts.addTo(this.container)},enable:function(){this.enabled=!0,this.sprite.alpha=1,this.render(),this.sprite.remove(),this.sprite.addTo(this.container),this.texts.remove(),this.texts.addTo(this.container)},disable:function(){this.enabled=!1,this.sprite.alpha=.7,this.render(),this.sprite.remove(),this.sprite.addTo(this.container),this.texts.remove(),this.texts.addTo(this.container)},onClick:function(t){this.enabled&&this.scale&&(game.scene.current=this,this.offset.x=this.sprite.position.x-t.global.x,this.offset.y=this.sprite.position.y-t.global.y,this.sprite.scale.set(1.1,1.1),this.texts.scale.set(1.1,1.1),this.sprite.remove(),this.sprite.addTo(this.container),this.texts.remove(),this.texts.addTo(this.container))},onRelease:function(){this.enabled&&(this.scale&&(game.scene.current=null,this.sprite.scale.set(1,1),this.texts.scale.set(1,1)),this.callback())},onHover:function(){this.enabled&&(this.sprite.alpha=.9)},onLeave:function(){this.enabled&&(this.scale&&(this.sprite.scale.set(1,1),this.texts.scale.set(1,1)),this.sprite.alpha=1,this.sprite.remove(),this.sprite.addTo(this.container),this.texts.remove(),this.texts.addTo(this.container))}})});
